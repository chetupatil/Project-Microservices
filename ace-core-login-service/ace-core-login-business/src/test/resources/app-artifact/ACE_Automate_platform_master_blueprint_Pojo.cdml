# --------------------------------------------------------------------------------------------------------------------------------------------------------#
# Name : ACE_Automate_platform_master_blueprint
# This is a blueprint template written in CDML (Continuous Delivery Markup Language) which will be used by Domain Architect to create Solution Blueprints
# --------------------------------------------------------------------------------------------------------------------------------------------------------#
# Description : 
# This file consists of the sections mentioned below
#   1. config       - Contains Blueprint metadata
#   2. projectInfo  - Contains Project metadata
#   3. alm          - Contains details required for Requirement management tool
#   4. scm          - Contains details required for Source Code Management tool data 
#   5. ci           - Contains details required for Cont Integration tool data
#   6. brm          - Contains details required for Binary Repo Management tool data
#   7. ide          - Contains details required for Integrated Desktop Environment tool data
#
# Usage :
# Each of the above section has a guideline subsection which in turn provides more details on the fields applicable and the possible values with examples
#
# Common functions :
# Each Section also has a validator subsection which give information about the fields which has to be mandatorily filled
# Fields marked with immutable true cannot be overriden at Solution level (ver:03-06-2019)
# --------------------------------------------------------------------------------------------------------------------------------------------------------#
config:
  validator:
    - node_name: "serviceType"
      type: mandatory_validator
    - node_name: "productRelease"
      type: mandatory_validator
    - node_name: "domainID"
      type: mandatory_validator
    - node_name: "solnID"
      type: mandatory_validator
    - node_name: "orgID"
      type: mandatory_validator
    - node_name: "verID"
      type: mandatory_validator
    - node_name: "domainID"
      allowed_value_list:
        - CLOUD
        - DOOSS
        - DIGNE
        - DIGIN
        - ENSON
        - DEMON        
      type: allowed_value_validator 
    - node_name: "orgID"
      allowed_value_list:
        - NSWPS
      type: allowed_value_validator 
    - node_conditional:
        domainID:
           - CLOUD
        solnID:      
           - CBS
      type: conditional_equality_validator
    - node_conditional:
        domainID:
          - ENSON
        solnID:
           - EDN
           - AUTO           
      type: conditional_equality_validator
    - node_name: "serviceType"
      allowed_value_list:
        - 3PL
        - 3PF
        - 3PS
        - OTH
        - ASR
        - TCG
      type: allowed_value_validator 
  serviceType: ""
  verID: 01
  productRelease:
  description: ""
  email: ""
  orgID: "NSWPS"
  domainID: ""
  solnID: ""
  productHierarchy: ""
  servicesBLHierarchy: ""
  supportUrls:
    - ""
    - ""
  reusable: FALSE
projectInfo:
  baseCode: ""
  validator:
    - node_name: "baseCode"
      type: mandatory_validator
alm:
  reusabilityLevel: null
  roles:
    - ProjectLead
    - Developers
  tool: jira
  backlog:
  - operation: '' 
    issueId: 6
    jiraIssueID: 
    issueType: Test
    epicName: 
    summary: ''
    labels:
    releaseLink: ''
    description: ''
    epicLink: ''
    priority: ''
    issueLink: ''
    parentId: ''
    component: ''
    labelID: ''
    originalEstimate: ''
    assignee: ''
    testCaseId: ''
    testTag: ''
    testFrameWork: ''
    market: ''
    deliveryCenter: ''
    deliveryManager: '' 
    productRelease: ''
    caseType: ''
    siteName: ''
    phase: ''
    projectManager: ''
    solutionArea: ''
    opportunityNumber: ''
    projectStatus: ''
    subDomain: ''
    projectProgress: ''
    careHandover: ''
    automation: ''
    escalation: ''
    customer: ''
  - operation: '' 
    issueId: 7
    jiraIssueID: 
    issueType: Test
    epicName: 
    summary: ''
    labels:
    releaseLink: ''
    description: ''
    epicLink: 1
    priority: ''
    issueLink: 1
    parentId: 1
    component: ''
    labelID: ''
    originalEstimate: ''
    assignee: ''
    testCaseId: ''
    testTag: ''
    testFrameWork: ''
    market: ''
    deliveryCenter: ''
    deliveryManager: '' 
    productRelease: ''
    caseType: ''
    siteName: ''
    phase: ''
    projectManager: ''
    solutionArea: ''
    opportunityNumber: ''
    projectStatus: ''
    subDomain: ''
    projectProgress: ''
    careHandover: ''
    automation: ''
    escalation: ''
    customer: ''
  typeID: ""
  namespaceID: ""
scm:
  toolRequired: "YES"
  reusabilityLevel: Reusability at Product Level
  validator:
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"  
        - "NULL"  
      type: allowed_value_validator
  gerrit: 
      tool: gerrit
      validator:
        - node_name: "roles"
          type: mandatory_validator
        - node_name: "roles"
          allowed_value_list:
            - Developers
            - Read-Onlys
            - Config-Mgmt
            - Reviewers
          type: allowed_value_validator
      roles:
        - Developers
        - Config_Mgmt
        - Read-Only
        - Reviewers
      defaultRoles:
        - Config-Mgmt: gdcgerritservice,cloud-jenkins
        - Developers: null
        - Read-Only: null
        - Reviewers: null
      repository:
        validator: 
          - node_name: "references/name"
            allowed_value_list:
              - refs/*
              - refs/for/*
              - refs/for/refs/*
              - refs/heads/*
              - refs/meta/config
            type: immutable_fields_validator     
        references:
          - name: refs/*
            owner:
              - "Config-Mgmt"
            read:
              - "Read-Onlys"
          - name: refs/for/*
            read:
              - "Config-Mgmt"
            push:
              - "Config-Mgmt"
            labelCodeReview:
              - "Reviewers"
          - name: refs/for/refs/*
            push:
              - "Developers"
            pushMerge:
              - "Developers"
          - name: refs/heads/*
            read:
              - "Config-Mgmt"
            push:
              - "Config-Mgmt"
            labelCodeReview:
              - "Developers"
          - name: refs/meta/config
            read:
              - "Developers"
  gitlab:
      tool: Gitlab
      roles:
        - Developers
        - Admin
        - Maintainer
        - Guest/Reporter
      validator:
        - node_name: "roles"
          type: mandatory_validator
        - node_name: "roles"
          allowed_value_list:
            - Developers
            - Admin
            - Maintainer
            - Guest/Reporter
          type: allowed_value_validator
        
ci:
  toolRequired: "YES"
  reusabilityLevel: NULL
  validator:
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"
        - "NULL"    
      type: allowed_value_validator
    - node_name: "toolRequired"
      type: mandatory_validator
    - node_name: "reusabilityLevel"
      type: mandatory_validator
    - node_name: "roles"
      allowed_value_list:
        - PipelineUsers
        - Promote 
        - buildonly
        - readWrite       
      type: allowed_value_validator
  roles:
    -  PipelineUsers
    -  Promote 
    -  buildonly
    -  readWrite
  jobs:
      - jobName: NB
        filePath: Jenkinsfile_nb
        trigger: H 12 * * *
        branch: master
      - jobName: NB
        filePath: Jenkinsfile_nb
        trigger: H 12 * * *
        branch: master  
  credentialID: nswps-gerrit
brm:
  toolRequired: "YES"
  tool: Artifactory
  validator:
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"
        - "NULL"    
      type: allowed_value_validator
    - node_name: "credentialID"
      type: mandatory_validator
    - node_name: "puname"
      type: mandatory_validator
    - node_name: "buildType"
      type: mandatory_validator
    - node_name: "artifactFolder"
      type: mandatory_validator
    - node_name: "pattern"
      type: mandatory_validator
    - node_name: "toolRequired"
      type: mandatory_validator
    - node_name: "puname"
      allowed_value_list:
        - NSWPS
      type: allowed_value_validator 
    - node_name: "buildType"
      allowed_value_list:
        - generic
        - mvn
        - rpm
        - docker
        - pypi
        - yum
        - helm
        - npm
      type: allowed_value_validator 
    - node_name: "artifactFolder"
      allowed_value_list:
        - snapshots
        - inprogress
        - candidates
        - releases
      type: allowed_value_validator 
  credentialID: 
  puname: NSWPS
  buildType: 
  artifactFolder: 
  pattern: 
ide:
  toolRequired: "YES"
  tool: eclipse_che
  stack: 'eclipse/ubuntu_python:latest'
  project_description: IDE provides python on Ubuntu
  project_type: python
  namespace: NSWPS-ACE
  description: Linux env
  validator:
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"
        - "NULL"    
      type: allowed_value_validator
    - node_name: "projects"
      min: 1
      type: min_max_validator
    - node_name: "namespace"
      type: mandatory_validator
    - node_name: "stack"
      type: mandatory_validator
    - node_name: "project_type"
      type: mandatory_validator
    - node_name: "toolRequired"
      type: mandatory_validator
    - node_name: "namespace"
      allowed_value_list:
        - "NSWPS-ACE"
      type: allowed_value_validator 
    - node_name: "stack"
      allowed_value_list:
          - eclipse/ubuntu_jdk8
          - eclipse/cpp_gcc
          - eclipse/node
          - eclipse/dotnet_core
          - registry.centos.org/che-stacks/centos-go
          - eclipse/centos_jdk8
          - eclipse/android
          - registry.centos.org/che-stacks/spring-boot
          - registry.centos.org/che-stacks/centos-ceylon-nodejs-dart
          - eclipse/centos_jdk8
          - eclipse/kotlin
          - eclipse/ubuntu_python:latest
          - eclipse/ruby_rails
      type: allowed_value_validator 
ct:
  toolRequired: "YES"
  testArtifactRepo: ''
  testFrameWork: ''
  dockerImage: ''
  tool: cctf
  validator:
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"
        - "NULL"   
      type: allowed_value_validator
    - node_name: "testArtifactRepo"
      type: mandatory_validator
    - node_name: "testFrameWork"
      type: mandatory_validator
    - node_name: "dockerImage"
      type: mandatory_validator
    - node_name: "tool"
      type: mandatory_validator
    - node_name: "toolRequired"
      type: mandatory_validator
      
infra:
  tool: vlab
  toolRequired: "YES"
  deploymentType: "G"
  persistentDays: 0
  ncrt:
      ciqLocation: "/Deployment/VLAB/workflows/ncrt"
      validator:
        - node_name: "ciqLocation"
          type: mandatory_validator
  cloudbandStack:
      cbamVersion: "18.5"
      cbndVersion: "19"
      cbisVersion: "18.5"
      validator:
      - node_name: "cbamVersion"
        type: mandatory_validator
      - node_name: "cbndVersion"
        type: mandatory_validator
      - node_name: "cbisVersion"
        type: mandatory_validator
      - node_name: "cbamVersion"
        allowed_value_list:
          - "18.5"
          - "19"
        type: allowed_value_validator
      - node_name: "cbndVersion"
        allowed_value_list:
          - "19"
          - "18.5"
          - "18"
        type: allowed_value_validator
      - node_name: "cbisVersion"
        allowed_value_list:
          - "19.5"
          - "18"
          - "18.5"
        type: allowed_value_validator
  productRelease:
      vnfdPath: "/Deployment/VLAB/workflows/vnfdPath"
      qcow2ImagePath: "/Deployment/VLAB/workflows/imagePath"
      nsdPath: "/Deployment/VLAB/workflows/nsdPath"
      validator:
        - node_name: "vnfdPath"
          type: mandatory_validator
        - node_name: "qcow2ImagePath"
          type: mandatory_validator
        - node_name: "nsdPath"
          type: mandatory_validator
        - node_name: "vnfdPath"
          allowed_value_list:
            - "path_1"
            - "path_2"
            - "path_3"
          type: allowed_value_validator
        - node_name: "nsdPath"
          allowed_value_list:
            - "path_1"
            - "path_2"
          type: allowed_value_validator
  validator:
    - node_name: "deploymentType"
      type: mandatory_validator
    - node_name: "toolRequired"
      type: mandatory_validator
    - node_name: "toolRequired"
      type: mandatory_validator
    - node_name: "deploymentType"
      allowed_value_list:
        - "G"
        - "C"
        - "N"
      type: allowed_value_validator
    - node_name: "toolRequired"
      allowed_value_list:
        - "YES"
        - "NO"
      type: allowed_value_validator
    - node_name: "persistentDays"
      max: 7
      min: 1
      type: min_max_validator